{"version":3,"sources":["cluster.js"],"names":["Cluster","config","request","paramExcludes","concat","Request","options","callback","name","Error","path","utils","pathAppend","delete","field","fields","getFieldSyntax","query","exclude","indices","get","node","getNodeSyntax","meta","put","commands","post","data","persistent","transient","module","exports"],"mappings":"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","sourcesContent":["import * as utils from './utils';\nimport { Request } from 'reqlib';\n\nclass Cluster {\n\tconstructor (config, request) {\n\t\tthis.config = config;\n\t\tthis.paramExcludes = Object\n\t\t\t.keys(config)\n\t\t\t.concat(['field', 'fields', 'node', 'nodes']);\n\t\tthis.request = request || new Request(this.config);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/river/\n\tdeleteRiver (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tif (!options.name) {\n\t\t\treturn callback(new Error('name is required'));\n\t\t}\n\n\t\toptions.path = utils.pathAppend('_river', options.name);\n\n\t\treturn this.request.delete(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-nodes-stats/\n\tfieldStats (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tif (!options.field && !options.fields) {\n\t\t\treturn callback(new Error('fields are required'));\n\t\t}\n\n\t\tlet fields = utils.getFieldSyntax(options);\n\n\t\t// specific exclude of indices param for this operation only\n\t\toptions.query = utils.exclude(options, this.paramExcludes.concat('indices'));\n\t\toptions.query.fields = fields;\n\n\t\toptions.path = utils.pathAppend(\n\t\t\toptions.indices ? '_nodes/stats/indices' : '_stats/fielddata');\n\n\t\treturn this.request.get(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-health/\n\thealth (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\t\toptions.path = utils.pathAppend('_cluster/health');\n\n\t\treturn this.request.get(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-nodes-hot-threads/\n\t// Warning: API is an experiment as documented on ES.org\n\thotThreads (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet node = utils.getNodeSyntax(options, this.config);\n\n\t\toptions.path = utils.pathAppend('_nodes', node, 'hot_threads');\n\n\t\treturn this.request.get(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-nodes-info/\n\tnodesInfo (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet node = utils.getNodeSyntax(options, this.config);\n\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\n\t\toptions.path = utils.pathAppend('_nodes', node);\n\n\t\treturn this.request.get(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-nodes-stats/\n\tnodesStats (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet node = utils.getNodeSyntax(options, this.config);\n\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\n\t\toptions.path = utils.pathAppend('_nodes', node, 'stats');\n\n\t\treturn this.request.get(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/river/\n\tputRiver (options = {}, meta, callback) {\n\t\tif (!callback && typeof meta === 'function') {\n\t\t\tcallback = meta;\n\t\t\tmeta = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tif (!options.name) {\n\t\t\treturn callback(new Error('name is required'));\n\t\t}\n\n\t\toptions.path = utils.pathAppend('_river', options.name, '_meta');\n\n\t\treturn this.request.put(options, meta, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-update-reroute/\n\treroute (options = {}, commands, callback) {\n\t\tif (!callback && typeof commands === 'function') {\n\t\t\tcallback = commands;\n\t\t\tcommands = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tif (!commands && options && options.commands) {\n\t\t\tcommands = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\t\toptions.path = utils.pathAppend('_cluster/reroute');\n\n\t\treturn this.request.post(options, commands, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/river/\n\trivers (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tif (!options.name) {\n\t\t\treturn callback(new Error('name is required'));\n\t\t}\n\n\t\toptions.path = utils.pathAppend('_river', options.name, '_meta');\n\n\t\treturn this.request.get(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-update-settings/\n\tsettings (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\toptions.path = utils.pathAppend('_cluster/settings');\n\n\t\treturn this.request.get(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-nodes-shutdown/\n\tshutdown (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet node = utils.getNodeSyntax(options, this.config);\n\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\n\t\toptions.path = utils.pathAppend('_cluster', 'nodes', node, '_shutdown');\n\n\t\treturn this.request.post(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-state/\n\tstate (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\t\toptions.path = utils.pathAppend('_cluster/state');\n\n\t\treturn this.request.get(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-update-settings/\n\tupdateSettings (options = {}, data, callback) {\n\t\tif (!callback && typeof data === 'function') {\n\t\t\tcallback = data;\n\t\t\tdata = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tif (!data && options && (options.persistent || options.transient)) {\n\t\t\tdata = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\toptions.path = utils.pathAppend('_cluster/settings');\n\n\t\treturn this.request.put(options, data, callback);\n\t}\n}\n\nmodule.exports = { Cluster };"],"file":"cluster.js"}